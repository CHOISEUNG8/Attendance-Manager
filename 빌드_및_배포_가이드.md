# 근태관리 프로그램 EXE 빌드 및 배포 가이드

## 📋 목차
1. [빌드 방법](#빌드-방법)
2. [배포 방법](#배포-방법)
3. [문제 해결](#문제-해결)

---

## 🔨 빌드 방법

### 방법 1: Spec 파일 사용 (권장) ⭐

가장 안정적이고 빠른 방법입니다.

1. **빌드 스크립트 실행**
   ```
   build_exe_spec.bat
   ```
   또는 더블클릭하여 실행

2. **빌드 완료 확인**
   - `dist` 폴더에 `WB_Attendance_Manager_v4_1.exe` 파일이 생성됩니다.
   - 파일 크기는 약 150-200MB 정도입니다.

### 방법 2: 기본 빌드 스크립트 사용

1. **빌드 스크립트 실행**
   ```
   build_exe.bat
   ```
   또는 더블클릭하여 실행

### 방법 3: 수동 빌드

명령 프롬프트에서 실행:

```bash
# PyInstaller 설치
pip install pyinstaller

# Spec 파일로 빌드
pyinstaller wb_attendance_v4_1.spec --clean --noconfirm
```

---

## 📦 배포 방법

### 단일 파일 배포

1. **필수 파일**
   - `dist\WB_Attendance_Manager_v4_1.exe` 파일만 배포하면 됩니다.

2. **선택 파일**
   - `favicon.ico` (아이콘 파일, 선택사항)

### 배포 패키지 구성

```
배포폴더/
├── WB_Attendance_Manager_v4_1.exe  (필수)
├── favicon.ico           (선택사항)
└── README.txt           (사용 가이드, 선택사항)
```

### 사용자 컴퓨터에서 실행

1. `WB_Attendance_Manager_v4_1.exe` 파일을 원하는 위치에 복사
2. 더블클릭하여 실행
3. 프로그램이 자동으로 `leave_attendance.db` 데이터베이스 파일을 생성합니다.

---

## ⚠️ 주의사항

### 1. 첫 실행 시 시간
- EXE 파일을 처음 실행할 때는 압축 해제 과정으로 인해 10-30초 정도 걸릴 수 있습니다.
- 이후 실행은 정상 속도로 실행됩니다.

### 2. 바이러스 백신 프로그램
- 일부 바이러스 백신 프로그램이 PyInstaller로 만든 EXE 파일을 의심스러운 파일로 감지할 수 있습니다.
- 이는 정상적인 현상이며, 프로그램에 문제가 없습니다.
- 필요시 바이러스 백신 프로그램에서 예외 처리하세요.

### 3. 데이터베이스 파일
- 프로그램 실행 시 EXE 파일과 같은 폴더에 `leave_attendance.db` 파일이 생성됩니다.
- **중요**: 데이터를 보존하려면 이 파일을 정기적으로 백업하세요.
- 다른 컴퓨터로 이동할 때는 EXE 파일과 함께 DB 파일도 복사해야 합니다.

### 4. 파일 크기
- PySide6와 pandas를 포함하므로 EXE 파일 크기가 약 150-200MB 정도입니다.
- 이는 정상적인 크기입니다.

### 5. Windows 버전
- Windows 7 이상에서 실행 가능합니다.
- Windows 10/11에서 최적화되어 있습니다.

---

## 🛠️ 문제 해결

### 빌드 오류 발생 시

#### 1. 패키지 설치 확인
```bash
pip install --upgrade -r requirements.txt
```

#### 2. PyInstaller 업그레이드
```bash
pip install --upgrade pyinstaller
```

#### 3. 빌드 캐시 삭제 후 재빌드
```bash
# Windows 명령 프롬프트
rmdir /s /q build dist
del *.spec
```

그 다음 다시 빌드:
```bash
build_exe_spec.bat
```

#### 4. Python 버전 확인
- Python 3.8 이상이 필요합니다.
```bash
python --version
```

### 실행 오류 발생 시

#### 1. 관리자 권한으로 실행
- EXE 파일을 우클릭 → "관리자 권한으로 실행"

#### 2. Visual C++ 재배포 가능 패키지 설치
- Microsoft Visual C++ 2015-2022 Redistributable 설치 필요
- 다운로드: https://aka.ms/vs/17/release/vc_redist.x64.exe

#### 3. Windows Defender 예외 처리
1. Windows 보안 → 바이러스 및 위협 방지
2. "바이러스 및 위협 방지 설정" → "설정 관리"
3. "제외 추가 또는 제거" → EXE 파일 경로 추가

#### 4. 오류 메시지 확인
- EXE 파일을 명령 프롬프트에서 실행하여 오류 메시지 확인:
```bash
cd dist
근태관리프로그램.exe
```

---

## 📝 배포 체크리스트

빌드 전:
- [ ] 모든 기능이 정상 작동하는지 테스트
- [ ] `requirements.txt`에 모든 패키지가 포함되어 있는지 확인
- [ ] `favicon.ico` 파일이 있는지 확인

빌드 후:
- [ ] `dist\근태관리프로그램.exe` 파일이 생성되었는지 확인
- [ ] EXE 파일을 실행하여 정상 작동하는지 테스트
- [ ] 파일 크기가 적절한지 확인 (150-200MB)

배포 전:
- [ ] EXE 파일을 다른 폴더에서 실행 테스트
- [ ] 데이터베이스 파일이 정상적으로 생성되는지 확인
- [ ] 엑셀 업로드/다운로드 기능 테스트

---

## 📞 추가 도움말

빌드나 실행 중 문제가 발생하면:
1. 오류 메시지를 확인하세요
2. 위의 문제 해결 섹션을 참고하세요
3. Python 버전과 패키지 버전을 확인하세요

---

**버전**: V2.2  
**최종 업데이트**: 2025년

